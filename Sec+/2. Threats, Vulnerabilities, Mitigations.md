#### Threat Actors
- Entity responsible for an event that has impact on safety
- Why it is happening?
- Goal?
- What makes them tick?
	- Espionage
	- Data exfiltration
- **Nation states**
	- external
	- Data exfiltration, revenge, disruption
	- Constant attacks, massive resources- Advanced Persistent Threat(APT)
	- Highest sophistication
		- Military control, utilities, financial control
- **Unskilled attacker**
	- Motivated by the hunt
		-  internal/external
		- motivated by - Disruption, data exfiltration
- **Hacktivist**
	- motivated by philosophy, revenge
	- external entity
	- sophisticated
	- Very specific hacks - DoS, web site defacing, docs release
	- funding limited
- **Insider threat**
	- Motivated by revenge, financial gain
	- Extensive resource
	- internal
	- Medium lvl sophistication
		- know institutional knowledge
- **Organized crime**
	- Motivated by money
	- external
	- sophistical
	- Crime is organized
- **Shadow IT**
	- Going rogue
	- use the cloud
	- limited resource
	- May not have it knowledge
#### Threat vectors
- a method used by the attacker to gain access or infect 
- Message-based
	- Email, SMS
		- when is there Malicious link or file
	- Phishing attacks
		- people want you to click links
	- Social engineering
- Image-based
	- difficult to identify threat
	- SVG, XML
	- Concerns
		- HTML injection
		- Javascript attack code
- **File-based**
	- Adobe PDF
		- file format containing other objects
	- zip/rar
		- contains many different files
	- Microsoft Office
		- Documents with macros
- **Voice call**
	- Vishing
		- Phising over the phone
	- War dialing
		- automated Dialing, brute forcing the phone numbers
- **Removable device**
	- USB flash drives
		- Malicious
		- bad usb
		- data exfiltration
- **Unsupported systems**
	- patching is important
- **Unsecure networks**
	- can view all non-encrypted data
	- outdated security protocols(WEP, WPA, WPA2)
	- **wireless**
		- single system could be an entry
	- Wired
		- unsecure interfaces - no 802.1x
	- Bluetooth
		- reconnaissance
- **Open service port**
	- firewall rules, must allow traffic to open port
- **Default credentials**
	- change default password!
	- right credential will gain you full control
- **Supply chain vectors**
	- Tamper with underlying infrastructure
	- Managed service providers(MSPs)
- Vulnerable software
	- Client-based
		- software is installed on your computer and isnt updated
	- Agentless
		- no installed executable
		- Client runs a new instance each time
### Social Engineering
#### Phising
- delivered by email, text
- check the URL
- look at spelling
- they are giving deadline
- we trust email sources
- **spoofed email addresses**
	- not legitimate
	- professor@professormessor.com
- Financial fraud
	- Sends email with updated bank information
- The attachment may be malware
- **Typesquatting**
	- change chars in the url
	- URL hijacking
- **Pretexting**
	- Lying to get information
	- attacker is character in situation they create
- **Vishing**(Voice phishing)
- **Smshing**(SMS phishing)
#### Impersonation
- Attackers pretend to be someone they aren't
- Attack the victim as someone in higher rank
- Eliciting information from the victim
	- hacking the human
- Identity fraud
	- your identity can be used by others
	- for
		- Bank fraud
		- Loan fraud
		- Government benefits fraud
- don't disclose personal details
	- verify the person, org
#### Watering hole attack
- the attackers can't get in
	- phishing emails
	- email attachemnts
- Have the mountain come to you
	- poison the water
- Determine which website the victim group uses(coffee or sandwich shop)
- Defense-in-depth
	- layer defense
	- Firewalls and IPS
#### Other
- **Misinformation/disinofrmation**
	- create confusion
	- influence campaigns
	- Nation-state actors
	- through Social media
- **Brand impersonation**
	- Pretend to be well-known brand
		- Coca-Cola, Apple, McDonald's
	- Create impersonated sites that get into Google index, adds
	- Visitors are presented with pop-ups
	- Malware infection is guaranteed
### Types of vulnerabilities
#### Memory Injection
- Malware runs in memory
- Malware is hidden somewhere
	- runs in its own process
	- injects itself into a legitimate process
		- Malware has same permissions as the legitimate process
		- DLL injection
			- windows libary 
			- Attacker inject a path to malicious DLL
			- Easy to implement
#### Buffer Overflows
- overwriting a buffer of memory
- privilege's escalation
#### Race condition
- If two operations **race** to modify the file, it can lead to unpredictable results.
- **Time-of-check to time-of-use attack(TOCTOU)**
	-  specific type of race condition where an attacker exploits the time gap between the **checking of a condition** (e.g., verifying permissions) and the **use of the resource** (e.g., accessing the file).
#### Malicious Updates
- always keep your operating system updated
- best practice
	- always have backup
	- Install from trusted sources
- confirm the source
- often app updates itself
#### OS
- millions of lines code
- vulnerabilities are already there
- Patch Tuesday - 2nd Tuesday of each month
- testing before deployment in in large environments
	- may require a reboot
	- have backup
#### SQLi
- add your own information into data stream
- data types
	- HTML
	- SQL
	- XML
	- LDAP
- **SQL injection**
	- put your own SQL request into an existing application
	- often executed in web browser
	- you have control over database
#### XSS(Cross-site scripting)
- commonly JavaScript
- takes advantage of the trust a user has a site 
- Non-persistent(reflected)
	- sends someone link
	- and in that page is malicious code
- Persistent(stored)
	- everyone gets the payload
- do not click on untrusted link
- consider disabling JavaScript
- most common vulnerability
#### Hardware Vulnerabilities
- IoT devices
- **Firmware**
	- software inside of hardware
	- only vendor can fix the device 
**End-of-life(EOL)**
	- manufacturer stops selling a product 
	- important for security patches
	- may continue support
**End of service life(EOSL)**
	- No longer selling, avable support
	- no going security patches or updates
- **Legacy platform**
	- Older OS, applications
	- may be running EOF
#### Virtualization security
- many similarities to physical machines
- VM escape
	- break out from VM and have great control of other VMs
- Resource reuse
	- hypervisor manages(allocating) relationship between physical and virtual
	- if the memory of all vms is higher then physical ram it may be slowed because only one can read/write
#### Cloud vulnerabilities
- most organizations have sensitive data in the cloud
- 76% of orgs don't use MFA
- 63% of code is unpatched in cloud
-  directory traversal
	- faulty configuration
- Remote code execution
- Attack the application
	- Log4j and Spring Cloud Function
	- easy to exploit 
	- XSS
	- Out of bounds write - crash the app
	- SQLi - get direct access to database
#### Supply chain Vulnerabilities
- chain contains many moving parts(Raw materials, suppliers, customers)
- Attacker can infect any of this steps
- Service provider
	- many providers
	- security audits
		- should be included in contract 
	- Hardware providers
		- can we trust server/router/switch
		- use small supplier base
		- strict controls over policies
	-  Software providers
		- need to have digital signatures during installation
#### Misconfiguration
- Open permissions
	- easy to leave a door open
	- common with cloud storage
- **Unsecured admin accounts**
	- 123456, ninja, football
	- disable direct login to the root account
	- protect accounts with root or admin access
- Insecure protocols, **isn't encrypted**
	- Telnet, FTP, SMTP, IMAP
	- view network packet
	- use instead - SSH, SFTP, IMAPS
- **Default settings**
	- Mirai botnet
		- takes advantage of def. conf.
		- 60+ default configuration
		- open-source
- Open ports and services
	- manage access
	- often manage with firewall
		- can be complex
#### Mobile device security
- difficult to secure
- always in motion
- constantly connected to internet
- Jailbreaking/rooting
	- Android - Rooting
	- Apple iOS - Jailbreaking
	- modifying or exploiting OS files to gain root privilages
- install custom firmware
	- circumvent security features
	- MDM becomes useless
- Sideloading
	- manage installation sources
		- global or local app store
	- install app from other sources than official(APK)
#### Zero day
- many application have vulnerabilities
- Attacker search for unknown vulnerabilities
- They create exploits against there vulnerabilities 
- unknown exploit, hard to defend against it
- CVE - Common Vulnerabilities and Exposures

#### Malware attacks
- data is valuable
	- How much it is worth?
- **Ransomware**
	- encrypts victim's data and is requiring payment for decryption
	- keep your OS, applications **up-to-date**
- **Trojan**
	- act as legitimate/harmless software
	- when executed attacker can do remote access, steal data, create backdoors
- **Worm**
	- it is malware that is spreading across network without requiring host program.
	- purpose is to spread malicious code, often it is used for DoS
- **Spyware**
	- designed to monitor and collect information without user's knowledge
	- capture credentials or gather sensitive information
- **Bloatware**
	- **pre-installed** on a system or device, often consuming excessive resources
- **Virus**
	- it attaches itself to program or file and spread when those file are executed 
	- To corrupt, delete or steal files
	- downtime
	- Fileless
		- avoiding anti-virus detection
		- opereates in memory 
- **KeyLogger**
	- design to record keystrokes
	- capture sensitive data, password, credit card 
- **Logic Bomb**
	- type of malware that is triggered by some condition(date, time, action)
	- delete files, corrupt data
- **Rootkit**
	- designed to gain unauthorized root-level access to a system while hidden from detection
#### Physical attacks
- if you have physical access, you have full control
- **Brute force**
	- check the windows
	- try doors
	- push through the obstruction 
- **RFID cloning**
	- access badges
	- duplication process takes seconds
	- use **MFA** to prevent from cloning
- **Environmental attacks**
	- operating environment
	- remove power
	- HVAC
	- fire suppression
#### Denial of Service
- Force a service to fail
	- overload the service
- create a smokescreen for some other exploit
- **friendly Dos**
	- Unintentional DoSing
	- connect 2 switches
	- download big file over small bandwidth
- **DDoS**
	- use an army of computers to bring down service
	- coordinated attack
	- Asymmetric threat
	- turn your small attack into a big attack 
	- NTP, DNS, ICMP request
#### DNS attacks
- **DNS poisoning**
	- modify DNS server
	- modify client host file
	- send a fake response to a valid DNS request
		- real-time redirection
- **Domain hijacking**
	- get access to domain registration
	- by
		- Brute force
		- Social engineering the password
- **URL hijacking**
	- make money from your mistakes
	- sell badly spelled domain to the actual owner
	- phishing site
	- drive-by download
#### Wireless Attacks
- **Wireless deauthentication**
	- wireless DoS attack
	- in 802.11ac and higher are management packets encrypted
		- Disassociate, deauthenticate
- **RF jamming**
	- Dos
		- prevent wireless communication
	- Decrease the signal-to-noise ratio at the receiving device
	- by
		- constant, random bits / Constant, legitimate frames
		- Data sent at random times
		- Reactive jamming - only when someone lese tries to communicate
	- fox hunting
		- You will need the directional antenna to locate them
#### On-path attacks
- aka man-in-the-middle
- redirect your traffic
- ARP poisoning
	- Arp has no security
	- local IP subnet
- On-path browser attack
	- Malware/Trojan does it through proxy
	- MIT-browser
	- wait for sensitive data
#### Replay attack
- Need access to the raw network data
	- ARP poisoning
	- Malware on victim computer
- when attacker intercepts credentials he can auth with them
- this is not on-path attack
- doesn't require original workstation
- protection
	- encryption
	- salting
- Cookies
	- session management, tracking, personalization
	- Session IDs are often stored in the cookie
- **Session hijacking**
	- do not need credentials
	- connect with cookie
	- end-to-end encryption
#### Malicious code
- many different forms
	- executable
	- scripts
	- macro viruses
- protection
	- AM
	- Firewall 
	- update and patch
#### Application attacks
- **code injection**
	- adding your own information into a data stream
		- enabled because bad programming
	- HTML, SQL, XML, LDAP
- **Privilege escalation**
	- gain higher-level access to a system
	- Protection
		- Patch quickly
		- update AV/AM
		- address space layout randomization
- **Cross-site request**
	- when your browser loads it from YouTube, Instagram
	- client
		- html, JavaScript
	- server
		- processing request
		- HTML, PHP
		- Transfer money
- **Cross-site request forgery**
	- one-click attack
		- XSRF, CSRF
	- when you login to bank and click to some link with malicious JavaScript, image
	- that can cause transfer funds, delete account
- **Directory traversal**
	- Read files from a web server
	- user shouldn't be able to browse the windows folder
	- ![[Pasted image 20250121055446.png]]
#### Cryptographic attacks
- you encrypted data and send it to another person
- **Birthday attack**
	- hash collision
		- same hash value for two different plaintexts
	- find collision through brute force
- **Collision**
	- MD5 - is vulnerable
- **Downgrade attack**
	- Force the system to downgrade their security
	- SSL stripping
		- combines an on-path attack with downgrade attack
	- Difficult to implement
	- attacker must be in middle of conversation
	- ![[Pasted image 20250121060801.png]]
#### Password Attacks
- Do not store password as plaintext!
- hash represent data as fixed-length 
- one-way
- type of Attacks
	- **Spraying**
		- most common passwords
		- try top 3 passwords
			- if they didnt work, move to the next account
			- no alarms or alerts
	- **Brute force**
		- most common offline
		- try every possible password combination
		- this will take more time
		- must have hash
#### Indicator of compromise(IOC)
- event that indicates an intrusion
- indicator
	- unusual amount of network activity
	- Change to file hash values
	- Irregular internal traffic
- **Account lockout**
	- credentials are not working
	- account was administratively disabled
- **Concurrent session usage**
	- Multiple account logins from multiple locations
	- difficult to track down
- **Blocked content**
	- attacker wants to be in system as long as possible
	- Auto-update connections
	- third-party anti-malware sites
- **Impossible travel**
	- logs
		- logon, logoff
	- Logining from very far distance
- **Resource consumption**
	- file transfers use bandwidth
		- an unusual spike at 3 am
	- Firewall logs show the outgoing transfer
	- first notification
- **Resource inaccessibility**
	- Server is not responding
	- encrypted data
		- ransomware
- **Out-of cycle logging**
	- Operating system patch logs
	- occurring outside of the normal patch day
	- Firewall log activity
		- timestamps of every traffic flow
- **Missing logs**
	- log information is evidence
	- information is everywhere
	- attacker will delete the logs
- **Published/documented**
	- unnoticed data exfiltration
	- the attackers post some data to public
#### Segmentation
- Physical, logical, virtual segmentation
- performance
- Access control lists(ACLs)
	- Allow or disallow traffic
		- grouping by categories
		- Source, destination IP, port number
		- restrict access to network devices
		- e.g.
			- bob can read files
			- Fred can access the network
		- Application allow/deny list
			- any dangerous application
			- allow
				- nothing runs unless it's approved
			- deny
				- nothing on the bad list can be executed
		- OS - windows
#### Mitigation Techniques
- reducing a risk of protentional event
- **patching**
	- monthly updates, third-party updates
	- auto-update
		- not best option in large environment
- Encryption
	- file system encryption
	- windows EFS
	- FDE - Full disk encryption
		- BitLocker
		- FireVault
	- Stored data
- Monitoring
	- Integrated into servers, routers, switches
	- Sensors
		- IPS, firewall logs, auth logs
	- Collectors
		- SIEM consoles, syslog servers
- Least privilege
	- permissions should be set to **minimum**
	- Don't allow users to run with administrative privilages
- Configuration enforcement
	- Each time a device connects
	- Checks
		- OS patch version
		- EDR version
		- certificate status
- Decommissioning
	- don't throw your data into the trash
	- storage devices
		- Hard drive
		- ssd
		- usb
	- remove
		- recycle the use for another system
		- destroy device
#### Hardening
- minimum password lengths and complexity
- account limitations
- limit network access
- AV, AM
-  Endpoint detection and response(EDR)
	- Signatures aren't the only detection tool
	- machine learning, behavioral analysis
	- root cause analysis
	- Respond to threat
		- Isolate the system, rollback previous config
		- API driven
- Host-based firewall
	- softwre-based
	- runs on every endpoint
	- allow/disallow incoming traffic
	- identify and block unknown processes
- Host-based Intrusion prevention system(HIPS)
	- recognize and block known attacks
	- Secure OS and application configs
	- looking for
		- Signatures
		- behavioral
		- Buffer overflow, registery updates
- **Change default password!**
- **Remove unnecessary software**