#### Secure baselines
- security of an application environment should be well defined
- Integrity measurements check
- **Establish baseline**
	- often available from the manufacturer
		- App dev
		- OS manufacturer
	- policies
- **Deploy baselines**
	- may require
		- AD group policy, MDM
	- usually managed by central console
- **Maintain**
	- rarely change
	- other baselines may require ongoing updates
	- test and measure to avoid conflicts
#### Hardening targets
- no system is secure with default configurations
- hardening guides are specific to platform or software
- **Mobile devices**
	- checklists are available from manufactures
	- Segmentation can protect data
	- Update  your phone
	- control wit MDM
- **Workstations**
	- desktop
	- constant monitoring and updates
	- automate the monthly patches
	- connect to policy management system
	- remove unnecessary software
- **Network infrastructure**
	- Switches, routers
	- purpose-built devices - embedded OS
	- configure auth, dont use defaults
	- check updates with the manufacturer
- **Cloud infrastructure**
	- least privilege
		- to all services
	- Configure **Endpoint Detection and Response**(EDR)
		- all devices accessing the cloud should be secure
		- always have backups(C2C)
- **Servers**
	- updates, service packs
	- User accounts
		-  minimum password lengths and complexity
	- account limitations
	- AV/AM
- **SCADA/ICS**
	- PC manages equipment
		- power gen, refining
		- facilities, industrial, energy
	- Distributed control systems
		- real-time information control
	- Requires extensive segmentation
		- no access from the outside
- **Embedded systems**
	- hardware and Software designed for a specific function
	- can be difficult to update
		- watches, TV - easy
	- segment and firewall
- **RTOS**
	- deterministic 
		- no time to wait for process
		- automobiles, military environments
	- isolate the system
	- run with the minimum services
- **IoT devices**
	- heating, cooling, lighting
	- weak defaults
		- change password
	- deploy updates quickly
	- segmentation
		- but IoT on their own segment
#### Securing Wireless and Mobile
- **Site surveys**
	- identify existing AP
	- work around existing frequencies
	- plan for ongoing site surveys
	- heat maps
		- identify strength
	- tools
		- signal coverage
		- potential inference
		- Built-in tools
		- 3rd-party
		- spectrum analyzer
- **MDM**
	- manage company owner and user-owned mobile devices(BYOD)
	- centralized management of the mobile devices
	- set policies on apps, data, camera
		- control remote device
	- manage access control
- **COPE(Corporate owned, personally enabled)**
	- company buys a the device
	- used for corporate and personal device
	- information is protected using policies
- **CYOD(Choose Your Own Device)**
	- Similar to COPE, but with the user's choice of device
- **Cellular networks**
	- "Cell" phones
	- 4G, 5G
	- separate land into cells
	- security concerns
		- traffic monitoring
		- location tracking
- **Bluetooth**
	- connects our mobiles devices
	- do not connect to unknown bluetooth devices
#### Wireless Security Settings
- encrypt wireless data
- verify message integrity check (MIC)
- WPA2 PSK problem
	- listen to four-way handshake - capture hash
	- attackers can brute force PSK
- WPA3 & GCMP
	- Wifi Protected Access 3
	- GCMP
		- block cipher mode
		- Galois/Counter mode protocol
		- has in it MIC
	- SAE
		- PSK authentication process
			- create a shared session key 
		- DHE key exchange with auth component
		- different session keys with same PSK
- Wireless auth methods
	- credentials
		- shared password / pre-shared key(PSK)
		- 802.1x, centralized authentication
	- home - WPA3-Personal / -PSK
		- one password
	- enterprise WPA3-Enterprise / WPA3-802.1X
		- for every user different credentials
- RADIUS(Remote authentication Dial-in User Service)
	- AAA protocol
	- centralize authentication for users
	- most common
- IEEE 802.1X
	- port-based NAC
	- you dont get access to the network until you authenticate
	- used with - RADIUS, LDAP, TACACS+
- EAP
	- many different ways to authenticate
#### Application Security
- balance between time and quality
- QA - Quality Assurance process
- input validation
	- forms, fields, type
	- check and correct all input
	- length, format
	- fuzzer will find what you missed
- Secure cookies
	- used for tracking, personalization, session management
		- not general security rick, till someone gets access to them
		- data file
	- sensitive information
- Static code analyzers
	- Static Application Security Testing (SAST)
		- help to identify security flaws
		- not everything can be identified through analysis
	- try to find vulnerabilities
	- have to verify each finding
- Code signing
	- has the application been modified?
	- asymmetric encryption
- Sandboxing
	- app cannot access unrelated resources
	- commonly used during development
	- deployments
		- VMs
		- Mobile devices
		- Browser iframes
- Monitoring
	- real time information
	- view blocked attacks
		- SQL injection attempts, patched vulnerabilities
	- audit logs
	- anomaly detection 
		- unusual file transfers
#### Asset management
- **Acquisition/procurement process**
	- purchasing process
	- start with request from user
	- negotiate with suppliers
		- terms and conditions
	- purchase, invoice, and payment
		- money part
- **Assignment/accounting**
	- central asset tracking system
	- **Ownership**
		- associate person with an asset
	- **Classification**
		- type of asset
		- Hardware/Software
- Monitoring/asset tracking
	- Inventory every asset
		- Laptop, desktop, servers
		- associate a support ticket with a device make and model
	- Enumeration
		- list all parts of an asset
		- CPU, memory, storage drive, keyboard
	- add an asset tag
		- barcode, tracking number
- Media sanitization
	- System disposal or decommissioning
		- completely remove data
	- different use case
		- clean HDD for future use
	- one-way trip
		- no recovery with forensics tools
	- Reuse
- Physical destruction
	- Shredder/pulverizer
		- complete destruction
	- Drill/hammer
		- all the way through platters
	- Electromagnetic
		- remove magnetic field
	- Incineration
- Certificate of destruction
	- done by 3rd party
	- need confirmation that data is destroyed
- Data retention
	- How much and where?
		- Copies, versions of copies
	- certain amount of data backup may be required
		- email, financial data
	- Operation needs
		- accidental deletion
		- disaster recovery
#### Identification methods
- Vulnerability scanning
	- usually minimally invasive
		- no penetration test
	- port scan
	- identify systems
	- test from the outside and inside
- Dynamic analysis(fuzzing)
	- send random input to and application
	- Looking for something out of the ordinary
		- application crash, server error
	- time, processor resource heavy
	- CERT **Basic Fuzzing Framework(BFF)**
- Package monitoring
	- open source
	- supply chain integrity
	- confirm if is the package legitimate
		- no added malware
#### Threat intelligence
- research thr threats
- make decisions based on this intelligence
	- best prevention
- used by researchers
- OSINT(Open-source intelligence)
	- Open-source
	- Internet
		- Discussion groups, social media
	- Government data
		- Mostly public hearings, reports
	- Commercial data
		- Maps, financial reports, DBs
	- **3rd party intelligence**
		- you can buy it
		- threat analytics
		- many data sources
		- constant threat monitoring
	- Information-sharing organization
		- public threat intelligence
			- classified information
		- Private threat intelligence
			- Private companies
		- **Cyber Threat Alliance(CTA)**
			- members upload specifically formatted TI
			- CTA scores each submission and validates
	- **Dark web**
		- hacking groups and services
			- activities
			- tools and techniques
			- credit card sales
		- Monitor forums for activity
			- Company names
#### Penetration testing
- Pentest
	- simulate attack
- similar to vulnerability scanning
- often 3rd party
- NIST - information to testing and assessment
- Rules of engagement
	- defines purpose and scope
	- type of testing and schedule
		- On-site physical breach, internal test
		- normal working hours, after 6 PM only
	- Rules
		- IP addresses ranges
		- Emergency contacts
		- Scope
- Exploiting vulnerabilities
	- try to break into system
		- buffer overflows can cause instability
		- Gain privilege escalation
	- different types
		- pass brute-force
		- Social engineering
		- Database injection
	- goal: **if you can bypass security**
	- The process
		- initial exploit
	- Lateral movement
		- move from system to system
	- Persistence
		- create way to back in
		- set up backdoor, build user accounts
	- The pivot
		- use a vulnerable system as proxy of relay
	- Responsible disclosure program
		- Software changes, testing, deployment
		- Bug bounty 
			- reward for finding bug
#### Analyzing Vulnerabilities
- **False positive**
	- vulnerability is identified that doesnt really exist
- **False negative**
	- vulnerability exists, but you didn't detect it
- Update to the latest signatures
	- work with vulnerability detection manufacturer
- Prioritizing vulnerabilities
	- not every vulnerability shares the same priority
	- Refer to public disclosure and vulnerability databases
	- CVSS - https://nvd.nist.gov/vuln-metrics/cvss
		- scoring 0-10
		- scoring standards change over time
		- Different scoring for CVSS 2.0 vs CVSS 3.x
	- CVE - https://www.cve.org/ProgramOrganization/CNAs#CNAProgramGrowth
- **Vulnerability classification**
	- scanner looks for everything
	- app scans
		- desktop, mobile apps
	- Web app scans
		- software on web server
	- Network scans
		- misconfigured firewalls, open ports
- **Exposure factor**
	- Loss of value or business activity if it is exploited in **%**
	- small DDoS may limit access to a service
		- 50% EF
	- consider when prioritizing
- **Environmental variables**
	- what type of vulnerability is associated with this environment?
	- Prioritization
		- isolated test lab vs database server in the public cloud
	- Environment is different
		- n of user and type(internal, external)
		- revenue of app
		- potential for exploit
- **Industry/organizational impact**
	- type of organization is important consideration
		- emergency
- **Risk tolerance**
	- How much risk will org accept to be unpatched.
	- testing takes time
	- middle ground
#### Vulnerability Remediation
- Patching
	- most common mitigation technique
	- Scheduled vulnerability/patch notices
		- monthly, quartely
	- Unscheduled patches
		- Zero day, often urgent
- Insurance
	- coverage
		- Lost revenue
		- Data recovery costs
		- Money lost to phishing
	- Doesnt cover 
		- Intentional acts, funds transfers
	- against Ransomware
- **Segmentation**
	- limit scope of exploit
	- NGFW block unwanted traffic between VLANs
- **Compensating problems**
	- can't deploy a patch right now
	- no internal firewalls
	- Compensate
		- disable service
		- revoke access to app
		- limit external access
		- software firewalls
- **Exceptions and exemptions**
	- everything cant be patched
	- balancing art
	- not all vulnerabilities share same severity
	- an exception may be option
		- formal process
- **Validation of remediation**
	- it is now patched
	- does it patch the exploit?
	- **Rescanning**
		- perform vulnerability scan
	- **Audit**
		- check system to ensure the patch was successful
	- **Verification**
		- Manually confirm security of the system
- **Reporting**
	- ongoing checks are required
	- continuous reporting
		- number of identified vulnerabilities
		- systems patched vs unpatched
		- new threats notification
		- errors, Exceptions and exemptions
#### Security monitoring
- attacker never sleep
	- 24/7/365
- Monitor all entry points
- react to security events
	- account access, firewall rulebase
- Status dashboards
- **Systems**
	- Authentication - logins from random places
	- Server monitoring - Service activity, backups, software version
- **Application**
	- Availability - uptime & response time
	- Data transfers - increases or decreases in rates
- **Infrastructure**
	- remote access systems - n of employees, vendors, guests
	- Firewall and IPS reports - Increase or type of attack
- **Log aggregation**
	- SIEM(Security Information and Event Manager)
	- consolidate many logs to central database
		- all information on one place
	- view authentication and access logs
- **Scanning**
	- new vulnerabilities discover daily
	- Actively check systems and devices
		- OS and version
		- device driver version
		- installed applications
	- gather the raw details
- **Reporting**
	- create actionable reports
	- status information
		- number of devices
	- determine best next steps
	- ad hoc information summaries
- **Archiving**
	- may have mandate
	- attacker can be longer time in the system
- **Alerting**
	- Real-time notification
		- large file transfers
		- authentication errors
- Alert response 
	- Quarantine
		- prevent protentional security issue from spreading
	- Alert tuning
		- prevent false positives and false negatives
	- alert should be accurate
#### Security tools
- Security Content Automation Protocol(SCAP)
	- NGFW, IPS
	- they have their own threats
	- https://csrc.nist.gov/projects/security-content-automation-protocol/
	- Allow tools to identify and act on the same criteria
		- validate security configuration
		- confirm patch installs
	- allows to automatically run vulnerability scans with different tools
- Benchmarks
	- apply security best-practice to everything
		- OS, CSP, MD
		- bare minimum for security settings
	- prebuild benchmarks: https://www.cisecurity.org/cis-benchmarks
- Agents/agentless
	- check to see if the device is in compliance
	- Agents
		- more detailed
		- always monitoring for real-time notification
		- must me maintained
	- Agentless
		- runs without install
		- perform the check, then disappears
- AV/AM
	- AV
		- refers specifically to type of malware
		- trojan, worms, macro viruses
	- AM
		- stops spyware, ransomware, fileless malware
	- the names are more marketing tool
- **Data Loss Prevention**(DLP)
	- check data and if it is sensitive information(e.g. SSN, credit card number, medical records) block it
	- stop data leakage
	-  required to use use the software on 
		- Endpoint clients
		- Cloud-based systems
- **SNMP**
	- Simple Network Management Protocol
	- database contains OIDs - Object Identifiers
	- poll devices udp/161
	- request from device to **server**, **firewall**
	- **Traps**
		- udp/162
		- if the number of CRC errors increases by 5, send trap
		- monitoring can react immediately
	- Low level information
- **NetFlow**
	- gather traffic statistics from all traffic flows
	- standard collection method
	- Probe and collector
		- probe watches network communication
		- Summary records are sent to the collector
#### Firewalls
- Filter by ==port number== or *application*
	- ==Traditional== vs *NGFW*
- Encrypt traffic
	- VPN concentrator
- most firewalls can be used as routers(L3)
	- NAT
	- Dynamic routing
- **NGFW**
	- L7 firewall
	- requires advanced decodes
		- every packet must be analyzed
- **Port and protocols**
	- traditional firewall
	- based on dis/allowing protocols and port numbers
- **rules**
	- top-to-bottom
	- specific rules at the top
	- Implicit deny
		- deny at the bottom
	- ACL(Access control list)
		- dis/Allow traffic
		- grouping of categories
			- source IP, destination IP, port number, time, app
- **Screened subnet**
	- the firewall layer is between you and internet
	- ![[Pasted image 20250126070300.png]]
	- public access to public resources
	- private remain inaccessible
- **IPS**
	- integrated into NGFW
	- signature-based
		- look for perfect match
	- build a baseline of what's normal
	- **rules**
		- determine what happens when unwanted traffic appears
		- 100+ rules
		- customized by groups
		- takes time to find right balance
			- false positives, alert "noise"
#### Web Filtering
- Content filtering
	- control traffic based on data within the content
	- control of inappropriate content
		- not safe for work
		- Parental controls
	- AV, AM
- **URL scanning**
	- Allow or restrict based on Uniform Resource Location
		- Uniform Resource Identifier(URI)
		- Allow, block list
		- managed by category, hacking, malware. travel
		- URLs aren't the only way to surf
		- integrated into NGFW
- **Agent based**
	- software on user's device
		- managed from central console
	- user can be located anywhere
	- updates must me updated
- **Proxies**
	- sits between the users and external network
	- caching, access control, URL filtering
	- forward
		- internal proxy
		- used to protect and control user access to the internet
- **Block rules**
	- url: *.professormesser.com: Allow
	- category of site
	- Different dispositions: 
		- Education: Allow
		- Gambling: Block
- **Reputation**
	- based on % risk
	- Risk: Trustworthy, Low risk, Medium risk...
	- Automated reputation
	- Add there dispositions  to the URL filter
		- High risk: Block
		- Trustworthy: Allow
- **DNS filtering**
	- perform DNS lookup
	- harmful sites are not resolved
#### OS security
- AD
	- database of everything on the network
		- computers, user accounts, file shares, printers, groups
	- manage auth
	- centralized access control
	- commonly used by help desk
- **Group Policy**
	- managed the computers or users
		- local & domain policies
	- central console
		- login scripts
		- network configuration(QoS)
	- Comprehensive control
- **Security-Enhanced Linux(SELinux)**
	- adds mandatory access control(MAC) to linux
	- linux tradionaly uses Discretionary Access Control(DAC)
	- limit app access
	- open source
- **Secure Protocols**
	- **unencrypted**
		- Telnet, FTP, SMTP, IMAP
		- capture packets
	- Email client access - IMAP - IMAPS
	- **Port selection**
		- port number does not guarantee security
	- **Transport method**
		- dont rely on the app
		- 802.11 Wireless
			- Open access point: No transport-level encryption
			- WPA3: all user data encrypted
		- VPN
#### Email Security
- **email spoofing**
	- check spam folder
	- email validation
- **Mail gateway**
	- Evaluates the source of email messages
	- block it at the gateway before it reaches the user
- **Sender Policy Framework**(SPF)
	- sender configures a list of all servers auth to send emails for a domain
	- TXT record
- Domain Keys Identified Mail(DKIM)
	- configure mail server to digitally sign outgoing mail
		- public key in TXT record
- **DMARC**
	- Domain-based Message Authentication, reporting, and Conformance
		- extension of PSF and DKIM
	- decides what to do with invalid emails using SPF DKIM
		- Accept all, send to spam, reject the email
	- reports to administrator
#### Monitoring Data
- **FIM(File Integrity Monitoring)**
	- some files should never change
	- monitor important OS and app files
		- identify when changes occur
	- Windows - **SFC** (System File Checker)
	- Linux - **Tripwire**
	- host-based **IPS** options
- **Data Loss Prevention(DLP)**
	- Where is your data?
	- stop data leakage
	- **on your computer**
		- Endpoint DLP
	- **On your network**
		- Data in motion
	- On your server
		- Data at rest
- **USB blocking**
	- Allow or deny certain tasks
- **Cloud-based DLP**
	- Located between users and the internet
	- block custom defined data strings
	- manage access to URLs
	- Block viruses and malware
- **DLP & email**
	- most critical vector
	- check every inbound and outbound email
	- Inbound
		- block keywords, quarantine email messages
	- outbound
		- Fake wire transfers, employee information
#### Endpoint security
- **endpoint**
	- user's access
- stop attackers
- many different platforms
- Defense in depth
- Edge vs access control
	- edge
		- protected by firewall rules
	- Access control
		- access can be based on many rules
		- access can be easily revoked or changed
- **Posture assessment**
	- you can't trust everyone
		- BYOD
		- Malware infections
		- Unauthorized applications
		- before connecting to the network perform health checks
			- trusted device?
			- running AV?
			- is disk encrypted?
	- Persistent agents
		- permanent 
		- periodic updates
	- Dissolvable gents
		- no install is required
		- runs during the posture assessment
	- Agentless NAC
		- checks made during login, logoff
		- can't be scheduled
- **Endpoint detection and response(EDR)**
	- method of threat protection
	- behavioral analysis, machine learning
	- lightweight agent
	- respond to threat
		- Isolate the system, quarantine the threat 
- **Extended Detection and Response(XDR)**
	- evolution of EDR
	- improved false positives
	- network-based detection
	- watching the user behavioral
	- Real-time detection of unusual activity
#### Identity and Access management
- **Identity and Access management(IAM)**
	- apps available anywhere
	- data can be located anywhere
	- Identify lifecycle management
		- every entity gets digital identity
	- AC
		- least privilege's
	- Authentication and Authorization
		- prove who you are
	- identity governance
		- Track an entity's resource access
- **de-/Provisioning  user accounts**
	- creation process
	- hiring, transfers, promotions
	- Account details
- Permission assignment
	- just enough to do their job
	- storage can be private to that user
	- no prevailed access to OS
- **Identity proofing**
	- confirm who I am
	- **Resolution**
	- **Validation**
		- gather information
	- **Verification**
		- passport, in-person meeting
- Single sign-on(SSO)
	- provide credentials one time
	- limited by time
	- not supported by everyone
- LDAP
	- accessing directories over IP network
	- X.500 written by ITU
	- used in Windows AD
	- Hierarchical structure
		- like tree
	- Container objects
- **Security Assertion Markup Language(SAML)**
	- Open standard for auth & authr
		- auth with 3rd party
	- not much supported for mobile apps
- **OAuth**
	- auth framework
		- determine what resources  a user will be able to access
	- created by X, Google
	- OpenID connect the SSO auth
	- provide auth between apps
- **Federation**
	- Provide network access to others
	- 3rd parties
	- login with Facebook credentials
		- establish relationship
- **Interoperability**
	- many different ways to communicate with auth server
	- determined by what is at hand
	- dependent on the environment